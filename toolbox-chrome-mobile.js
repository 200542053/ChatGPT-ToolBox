window.enableFakeMod=false;var nav=document.querySelector('nav');var aEle=nav.querySelectorAll('a');for(var i=0;i<aEle.length;i++){if(aEle[i].innerHTML.indexOf('FAQ')>=0){aEle[i].removeAttribute('href');aEle[i].innerHTML='[ ↑ ] 导出';aEle[i].onclick=function(){var conversation_id=localStorage.getItem("conversation_id_last")||"";var parent_message_id=localStorage.getItem("parent_message_id_last")||"";var authorization=localStorage.getItem("authorization_last");if(conversation_id==""||parent_message_id==""||conversation_id=="undefined"||parent_message_id=="undefined"){alert("请至少说两句话再使用这个功能!");return}var jsonObject={conversation_id:conversation_id,parent_message_id:parent_message_id,authorization:authorization};var jsonString=JSON.stringify(jsonObject);var base64String=window.btoa(jsonString);var textarea=document.querySelector("textarea");textarea.value=base64String;alert("存档已导出到聊天框文本框，请复制保存")}}if(aEle[i].innerHTML.indexOf('OpenAI Discord')>=0){aEle[i].removeAttribute('href');aEle[i].innerHTML='[ ↓ ] 导入';aEle[i].onclick=function(){var userInput=prompt("请黏贴存档到输入框");var decodedString=window.atob(userInput);var jsonObject=JSON.parse(decodedString);if(jsonObject.conversation_id===undefined||jsonObject.parent_message_id===undefined){alert("存档损坏或数据有误。");return}localStorage.setItem("next_conversation_id",jsonObject.conversation_id);localStorage.setItem("next_parent_message_id",jsonObject.parent_message_id);localStorage.setItem("import_authorization",jsonObject.authorization);alert("存档导入成功")}}if(aEle[i].innerHTML.indexOf('Thread')>=0){aEle[i].removeAttribute('href');aEle[i].innerHTML='[ ! ] 关闭监管&重置存档';aEle[i].onclick=function(){alert('模型监管接口将在点击确认后关闭，在此之前请确认您所在地法律法规！此外，导入的存档也将在刷新后失效。');window.enableFakeMod=true;localStorage.removeItem('import_authorization');localStorage.removeItem('next_parent_message_id');localStorage.removeItem('next_conversation_id');localStorage.removeItem('parent_message_id_last');localStorage.removeItem('conversation_id_last');var divs=document.getElementsByTagName('div');var lastDiv=null;for(var i=0;i<divs.length;i++){if(divs[i].innerHTML.includes("Free Research Preview")){lastDiv=divs[i]}}if(lastDiv){lastDiv.innerHTML="数据监管模式已关闭，请谨慎使用。";lastDiv.style.color="yellow"}}}}alert("赛博工具娘v1.0.6脚本已启用。本工具全程由ChatGPT在指导下自行研发~");const oldf=window.fetch;window.fetch=function(...args){if(args[0].includes("moderations")&&window.enableFakeMod){return new Response('{}',{status:200,statusText:"ok",})}if(args[0].includes("conversation")){var headers=new Headers(args[1].headers);const authorization=headers.get("authorization");localStorage.setItem("authorization_last",authorization);const au=localStorage.getItem("import_authorization");if(au){headers.set("authorization",au);args[1].headers=headers}if(args[1].body&&args[1].method==="POST"){if(localStorage.getItem("next_conversation_id")&&localStorage.getItem("next_parent_message_id")){var nextConversationId=localStorage.getItem("next_conversation_id");var nextParentMessageId=localStorage.getItem("next_parent_message_id");localStorage.removeItem("next_conversation_id");localStorage.removeItem("next_parent_message_id");var ob=JSON.parse(args[1].body);ob.conversation_id=nextConversationId;ob.parent_message_id=nextParentMessageId;args[1].body=JSON.stringify(ob)}else{const bb=JSON.parse(args[1].body);localStorage.setItem("conversation_id_last",bb.conversation_id||"");localStorage.setItem("parent_message_id_last",bb.parent_message_id||"");localStorage.setItem("body_last",args[1].body)}}}return oldf(...args)}
